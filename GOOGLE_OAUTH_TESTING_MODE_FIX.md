# Решение проблемы: Ошибка 403: access_denied при подключении второго Google аккаунта

## Проблема

При попытке подключить второй Google аккаунт для Google Search Console появляется ошибка:

```
Ошибка 403: access_denied

Мы пока не проверили приложение "seohqs.vercel.app". 
Сейчас оно тестируется и им могут пользоваться только одобренные разработчиком тестировщики.
```

## Причина

Приложение в Google Cloud Console находится в режиме **Testing** (тестирования). В этом режиме только пользователи, добавленные в список "Test users", могут авторизоваться через OAuth.

## Решение

У вас есть два варианта:

### Вариант 1: Добавить пользователя в список тестовых пользователей (быстрое решение)

1. Откройте [Google Cloud Console](https://console.cloud.google.com/)
2. Выберите ваш проект
3. Перейдите в **APIs & Services** → **OAuth consent screen**
4. Найдите раздел **Test users** (внизу страницы)
5. Нажмите **"+ ADD USERS"**
6. Введите email второго Google аккаунта, который вы хотите подключить
7. Нажмите **"ADD"**
8. Сохраните изменения
9. Подождите 1-2 минуты для применения изменений
10. Попробуйте авторизоваться снова с вторым аккаунтом

**Преимущества:**
- ✅ Быстрое решение
- ✅ Не требует верификации приложения Google
- ✅ Подходит для тестирования и ограниченного использования

**Недостатки:**
- ❌ Нужно добавлять каждого нового пользователя вручную
- ❌ Максимум 100 тестовых пользователей

### Вариант 2: Перевести приложение в режим Production (для широкого использования)

1. Откройте [Google Cloud Console](https://console.cloud.google.com/)
2. Выберите ваш проект
3. Перейдите в **APIs & Services** → **OAuth consent screen**
4. Нажмите **"PUBLISH APP"** (вверху страницы)
5. Подтвердите публикацию
6. Если Google запросит дополнительную информацию, заполните:
   - Privacy Policy URL (ссылка на политику конфиденциальности)
   - Terms of Service URL (ссылка на условия использования)
   - App logo (опционально)
   - Application home page
7. Отправьте приложение на проверку Google (если требуется)
8. После публикации любой пользователь сможет авторизоваться

**Преимущества:**
- ✅ Любой пользователь может авторизоваться без ограничений
- ✅ Не нужно добавлять пользователей вручную
- ✅ Подходит для продакшена

**Недостатки:**
- ❌ Может потребоваться верификация приложения Google
- ❌ Может занять несколько дней для проверки (если требуется)
- ❌ Нужны Privacy Policy и Terms of Service

## Рекомендация

- **Для тестирования и ограниченного использования:** Используйте Вариант 1 (добавление тестовых пользователей)
- **Для продакшена и широкого использования:** Используйте Вариант 2 (перевод в Production)

## Проверка текущего режима приложения

Чтобы проверить, в каком режиме находится ваше приложение:

1. Откройте [Google Cloud Console](https://console.cloud.google.com/)
2. Выберите ваш проект
3. Перейдите в **APIs & Services** → **OAuth consent screen**
4. Вверху страницы вы увидите статус:
   - **"Testing"** - приложение в режиме тестирования
   - **"In production"** - приложение в продакшене

## Дополнительная информация

### Ограничения режима Testing

- Максимум 100 тестовых пользователей
- Только добавленные пользователи могут авторизоваться
- Приложение не отображается в публичном списке приложений Google

### Требования для Production

- Privacy Policy URL (обязательно)
- Terms of Service URL (обязательно)
- Заполненная информация о приложении
- Возможна проверка Google (для некоторых типов приложений)

## После исправления

1. Подождите 1-2 минуты после внесения изменений
2. Попробуйте авторизоваться снова с вторым Google аккаунтом
3. Если проблема сохраняется, проверьте:
   - Правильность email адреса
   - Что email добавлен в список тестовых пользователей (для режима Testing)
   - Что приложение опубликовано (для режима Production)

## Связанные документы

- [GOOGLE_OAUTH_TROUBLESHOOTING.md](./GOOGLE_OAUTH_TROUBLESHOOTING.md) - общее устранение проблем с OAuth
- [GOOGLE_SEARCH_CONSOLE_OAUTH_SETUP.md](./GOOGLE_SEARCH_CONSOLE_OAUTH_SETUP.md) - настройка OAuth для Search Console
