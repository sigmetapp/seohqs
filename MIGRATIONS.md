# Миграции базы данных

## Описание

Система миграций автоматически создает и обновляет структуру базы данных.

## Первая миграция

Первая миграция `001_initial_schema_sqlite.sql` создает:
- Таблицу `affiliate_offers` для хранения данных о партнерских программах
- Таблицу `migrations` для отслеживания выполненных миграций
- Индексы для быстрого поиска

## Автоматический запуск

Миграции запускаются автоматически:
1. При первом подключении к базе данных (в `lib/db.ts`)
2. При загрузке главной страницы (через API `/api/migrate`)
3. Вручную через API endpoint `/api/migrate`

## Ручной запуск миграций

Вы можете запустить миграции вручную:

```bash
# Через API (GET или POST)
curl http://localhost:3000/api/migrate
```

Или откройте в браузере: `http://localhost:3000/api/migrate`

## Структура миграций

Миграции находятся в папке `/migrations/`:
- `001_initial_schema.sql` - для PostgreSQL/MySQL
- `001_initial_schema_sqlite.sql` - для SQLite

## Добавление новых миграций

1. Создайте новый файл в папке `/migrations/` с именем `002_description.sql`
2. Напишите SQL код для изменения структуры БД
3. Миграция выполнится автоматически при следующем запуске

## Проверка статуса миграций

Миграции отслеживаются в таблице `migrations`. Выполненные миграции не запускаются повторно.
